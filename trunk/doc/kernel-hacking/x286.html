<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN""http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>__initcall()/module_init()
    include/linux/init.h</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REL="HOME"
TITLE="Unreliable Guide To Hacking The Linux Kernel"
HREF="index.html"><LINK
REL="UP"
TITLE="Common Routines"
HREF="c140.html"><LINK
REL="PREVIOUS"
TITLE="__init/__exit/__initdata
    include/linux/init.h"
HREF="x274.html"><LINK
REL="NEXT"
TITLE=" module_exit()
    include/linux/init.h "
HREF="x299.html"></HEAD
><BODY
CLASS="sect1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Unreliable Guide To Hacking The Linux Kernel</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x274.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Chapter 6. Common Routines</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x299.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="routines-init-again"
>6.11. <CODE
CLASS="function"
>__initcall()</CODE
>/<CODE
CLASS="function"
>module_init()</CODE
>
    <TT
CLASS="filename"
>include/linux/init.h</TT
></A
></H1
><P
>&#13;    Many parts of the kernel are well served as a module
    (dynamically-loadable parts of the kernel).  Using the
    <CODE
CLASS="function"
>module_init()</CODE
> and
    <CODE
CLASS="function"
>module_exit()</CODE
> macros it is easy to write code
    without #ifdefs which can operate both as a module or built into
    the kernel.
   </P
><P
>&#13;    The <CODE
CLASS="function"
>module_init()</CODE
> macro defines which
    function is to be called at module insertion time (if the file is
    compiled as a module), or at boot time: if the file is not
    compiled as a module the <CODE
CLASS="function"
>module_init()</CODE
> macro
    becomes equivalent to <CODE
CLASS="function"
>__initcall()</CODE
>, which
    through linker magic ensures that the function is called on boot.
   </P
><P
>&#13;    The function can return a negative error number to cause
    module loading to fail (unfortunately, this has no effect if
    the module is compiled into the kernel).  This function is
    called in user context with interrupts enabled, so it can sleep.
   </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x274.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x299.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><SPAN
CLASS="type"
>__init</SPAN
>/<SPAN
CLASS="type"
>__exit</SPAN
>/<SPAN
CLASS="type"
>__initdata</SPAN
>
    <TT
CLASS="filename"
>include/linux/init.h</TT
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c140.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><CODE
CLASS="function"
>module_exit()</CODE
>
    <TT
CLASS="filename"
>include/linux/init.h</TT
></TD
></TR
></TABLE
></DIV
></BODY
></HTML
>